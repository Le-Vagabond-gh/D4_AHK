#NoEnv
#SingleInstance Force
SendMode Input
SetBatchLines -1
SetWorkingDir A_ScriptDir

#IfWinActive ahk_exe Diablo IV.exe

Base64PNG_icon := "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABbPSURBVHhe7VsHlFXltWZ6gelMuX3uDAMMKJJgijHGKBCxoBTBgiLFRCwoRhFQ6WVCrzNIHXqXohQpAtJhBKQpKJaEqEnUl+TlJfry1suX79vn3gnKIZF5a7IWrnfX2uvc+5//nPPv/e/97W///7l1/v/zNT6hhlc0Lm7U9MfhktIhl4NorJJQSZPmERVq9ilq2LhPUUnpW0UNm+CylZIm78sooVAoOaLWv/5oxnnx/gtudjkLJzLUoPH3Iype/EOLdeMFn19wg2+O9I+oeuEnMvPfZOVNhA8Rlb/84clvlttfTEpKPw6FrsqMqO18DPDcOl8gTVHU6B9Ca37p96WKro/Kl87pOV95VlTc+lbfw3XMF0q4YWllRHXnI7R063iBFDdCYbgBisIN7RgIh3ksRjHbi4rYVtwAhUUl9j3Mo/roaOeLeb6I59kWKipGiNfp+mC4CMGisLWFi0usv47qX30N7xv9bteqr54Tua/uE+B9XMfsLp9Xe4HypUuHC0QWDoRC8Pu9CAepeLAQAb8fhYUhFHNARcEiBAIBBANBk4CE5wP+AEL8HgoG4Q/54Qt44fEXwMf7OOcpAb+d132LQlREyvBYGNTz/LxfAOGAnhdAga+AbT72LURxIZ9bGLbfuidTnuvY3aS4YWk7M0BRSeO73TpcIDRAsLAQ3qCXSvjh9fng9fpM0UK2S2kN1h+kQlQmxMGHQzQUB+6XgoEQB1vE2WUbjVYYKqSC9AC2B9k3xO/M1yimZ0j5oF/3C/BeAbtev+077697awLMSLy/jwZQO+Pbfezu4mQEEQWXky7SlG5LV+Mg8vPzkZaejjp1YpCanIKCvAJ4PV4axWuzHOasaICaURlB1wRpFCldXEwFqWSYHhOK9Clk/wC/O8rJgzjT3gLOqsfxKiosQ5sh7DwNTMPJEPru8Xnsu/u43UV6X5oBFAKcOT1QBqiXlo57u3bloIM0RB1kpmfAV+BzZkNuzXYN3pQPOTMnBUzhyOzrXJhGLSYuFIeICezvZWgoPPxeeZnCxWNeomv1W/cPRgwaDNGoNJzH67FnXkoI1MgAQc6UWbzAg7i4OCxZsQLHTp1Cm3btEBcfb4bIyMhAQQE9Qt7AQZvQK+Tehgd+zhRnX/FrMcx4l5dIpHz17LKfn2Gm2Jb7W0jx+bqPvpsYJvnNAywE3MZ9EamRAQzZOThvgRcxVPau++6HPm9/+CFmLV2OG1rfhNjYOMTE0CNyMpHnyXNmjEpJUXNZKhMW0ElpeYNcn0Yyb6FIEXmGjODxeOx6YYzwI2oweYt+G6YoE/EeIXrVpWDApRtAebkBUw8f6vP4EBcbi+bf+S6OnX0X5377CXYdeQMHT57ClFlz0KxFC/OGhIQ45ORmm4tqtjTYUJgDJQaEFE5SlO0CVc20N8i4DzgzLsU9Xq+BnJT2hRxDyu0FfuZBNIQwpbiIvwWeruN2l5oZQLmXKc/v8yMxMYGD9GPrvgN48/0P8CsaYfWWLVj5yha8eqgKg0aOYhj4zRBpdetZWCgEFP+W6jR7PGqmLb6VFukBYZ7XMd+fz3anv+LdvEfhR0xQfwGlUqovSMPQKALK2vcAkRpaWwPKyshEcnIylq1Zi+2HDuODjz7GibPvo3z+AkyZMweb9+7F1j370ONnDyE5JdUMkZ2dbeAW8FGxgAOGGrhiW0rI9aWclJQHWEjwt6VQyxo0goCP19m1uibSR6BLXVzG7S41MkBYhEcpjg/35HtMqaFlv0DVW2cwb+VKfPqHP2LbgYOomD8f48orsGTdS9h/6k2semUzWt98i/WPJ0bkZOdY2tTgFb/yCOGBN+hxZpieE/ByhskzfAFiAPsU0gCF4hV8tgwm0JRRdF2Uf5DiuozbXS7dAATBQsZdyEf0ldt6HPe+t+sDBMGPMW3eArx+4iT+9JfPsWbrVkypnIfpCxdiWuV8bHhtD96mh4yZMg1XNv+WXacQUjq1sDAgdEBQ3iVPELKbp5iXEBOEF/QAiWbcwJVYofNSPihG6jbui0gNDeAwtJDYF4EwISEBV3/v+zh8+jRmLlqMybNm46Pf/Q4ffPgR5qxYhWdHlWHGokX0iHmYt2oV9hw7gUMnTmEIvSZAZJch6tata/gghYNKkxFMKCAoyiDGCmkAT8CJ/agB1Gahw6OfOKAQqF0MUBqkB4QZuzKCaHAG2WAa8/7GHa/h5W07UDZlChasWo3/+uK/8c65c5jEjDBozBhMmPkCZi9dSi9ZiFnLVuCVvfvxCvHh4d69kVrXwYd6aQRKMkp5lmbeS4CTSOEAZ7jaAIx7fRe5EpDqvFKqhVKtG0CVYCR/+zjInKwcDj4Gc5cuw+tn3sbUuZUYXV5OHDhg/KCK8T9s/AT0+nkfDPzFaEycORe/KJ+OSbPnYtG69Th08k28vHkLbrv9djOCRPiQX5BvHuYjEZJ7Szl5g0eFFNOkkF9pNECCZWmRhrCCrFYxIMoDWLoKgIJkavm5+YilAfoOeA5H3jnLeJ+HseVTmQVmoOrECXzxv3/Dpt17MWTseAweMw4jJk7CqElTaIBKTF+wCLOWLMfm3ftx4t33MJe/m33LwYekpETk1HcMIUYpA8gY8giBpI4iR6oW9V0TYiTJddzuUjMPYD1eRDIjA2hQQvIYGuDG1j/BybPvYdn69RhXUYFx0yvo8ivw3q8/xB8IitOJA4880xdPDxqMQePGYdiEieg7dBj6jRjJ8JiBUVOnYtv+gzh2+m0MHD6CnMAB2NSUFMs2XhIiFUcKAUt7EQIlXmC1BuPfQqHWPUALFsVODpYIwRPjE9GocSlOv/9LLF63Dk8NGoT+I0Zh+MQJKF+wAJ/8/g80zlkMGTcGIydPxZAJ4/FYv37oPeBZ9OzTB/f1epjtUzCZ3EEYsfvYSbx64BAefvwJZJE3yBDpGenMGKTVDAsxQ3EI4ZAMojojQDxQuqQuLuN2lxoagB6ggoTWDvpofeKAqsCszCys37YdC9euxQOPPoanhgzDgBHD0Oe55zF72TL8lkZ47fARvPTqTqx7dTsqmDFmETcmzJhFxSvxwqIlZoDxM2aibFo5r1mOfcdPYfPO3WjX6S7ExsRY7ZGdk2VG0HOlvBVHotTEAcOC2jcAMUDxL9ejm2ogBXn5NkvDxk3AK/sOmmsPIA0eOGYsBowayVmtZJzvxWCe7z+yjJ4wgedH00hD8VzZaOMPq7dsw8vMJC9texUrNmzE3BUraYxZWLVpC/a8cQKTaJjGV1zh4ENCIvJy86y+EBdQKCgsFAq1nwWIAQKcokCUxxeiIMIIez7yCKoYwzMWLqWy46joWIv1Xa8fwVSSoe+xUmxz1z24vcv9uPWee9D6zk5ow9lt3bET7nrwZ3i0X388OXAQqfRC7Hz9MPaRM+w5csxI1Sv79jJ17kNfnvfR+HqePM9AkvggA6hYoi7uY3eRGnlAWCFAD7BihpWYPKEgv4CVYRza3Hobjr/7PqbMnYtnRwxn2ivDaILb2+d+jafpFS3bd6SynXFbl/vQueeDaP9ANzNG23u74ObOd6Nlhztx052dcd2tbXFH1270kjLMWb4S6+kZ+984jqo332LN8TqLrc1o26kz6jAstPaQl5eHAg9JkzzAddzuUnMDMAtEubvoq1yxHqs9IfcOgtfCNWuY8kYzFIbSGxbhwPET6Ni9J9p17Y5OPR5Ehwe6U7rhjvu6mgF++vTT6Edl+w4fiV7P9EN3gt9Dz/TH80ydT7PtycFDLRyWr99kspYesb3qCO6kkWJohJycHFs3EJN0PICh6jr+L8v/wQCcfRYhIh/G4Vm4pJMRJiYlYR1nZ/OeXZbrf053nUGwW7lxE9redz86duthM9+xW3c7dn3kMcOLJ8ghOtMYP7yxFUpKqQC5RlPWC9e1+gnaduiInr2fYPocgr7DhmPinLlYvXUblry8Hpv27EWTK5shPi6OHpCPfG8+lWps43Qf/5fl0g0QYYJKQbaYaSsxYfOA9Kx0m43x0yqw9/hxDJ8wGd0fexwryAtmkQ/ceEcH3HbPvWjbpQs94QE79wyVV5V4S7v2FtMSVYrxcfGIjY2tbnNcPZOxH8D1LVuh1xN90Lv/ABp6LyqZLVJZS4iSKw3WKg/QvkCI8V9Aha1SUxYgD5AB6ufVt8F2pJJ7jx3D2IpyPEp3XkN0L5tagZsEdh06WbwPJTAOIAGaPHsOZ3IDllOuuKq5Xa/CKC09DWlpjsiz6tWrx8ox0QysPlHx0PPad+7M8XiRkpxCA2hNsJYNECT58fgKbPXGSIjSj4xAEKoTUwfNW1yNfQSsmWR+z5aNshl+pN8A/Oi2tri+7R2WCkeMH4/Fa1/CBoLbq/sOMEyWWOmcnJqK+Ph40uCkaiWV+5OofAoZoQwjQlS3Xl37HRvneEki02JaWjrDwMNx1mYWkAeoHKbSRoRIP7V8LS6ezxhMTkkmT/djzeatqFz1IlPgZHrAVtxJ4PtOy9Z4gpgwfvoLSKGi/YcOR8WChbZ+sGH7DpQTLO9/8CFTqJAY06bt7Wh/991odcutNHxjJCY7RpHiqhEyszPJErOQnZVtmcBhigUcZy0bwNYDZADRYKYdL8tSVWce8vSsrCwkcYATidhrWRqPZVW4aPVatCf4/aDNrZi+eAmub9XKFFEun0RAe2HhYnz82WcsipZiNPFj+Yur8cuPf4NffvoZTr3/ATbt2o0XWS3O5PnOxI70zExjhVJeiylWLdITnUXXwn/PgohcXhsVVpRwxjUADSQ3N9eUe4Iuv4aMbuSUybYk1rFbT3R6sBfGTJ+BunRVxbP6tbzlZsxYvBRL1q7DO786h+UbN+ALltC//dOfcYg5XxXioZOnsPPgISxl6bx840Yrtr7/wx/Z9RmZGZaBVJgVa8mdBqAu7mN3kRoZIMQHyQBatTEDUHFbHGHJKkKi2bmdzG7V5m108QUWAh3oAaPKK3A32Z4GrgWQ6CLIT5nzx8+cjT2Hj+IkZ3zP0TewgbM+md4xjvR33otrsOPQYWw/WEVjLcGclS8yDW7Htdf/2K7Prp9l47CMRAMUlbiM+yJSIwMoDWpXViRIGKBM4NQFMobf0Li02VV4iQCnErdy5Wr87KlnMGziJHg5U7GxMbbyE58QRzD1Yff+ffj0z38x/j+f7j+tcgELqIEYMn4Snmct8cCjvdG5x0/Ri/com1rOqnEaXqDXiAuESxoYEGrhVHwkXERuUusYEKG/eqAMIAC0BUkBIhXS+r9K2PkrVmAkB1y5ajV6S6GxY4nUTGdJCURxzr44A0tgfX7z2X/QC1gFTp2GgaPH4MlBg3Fz+w6M50bMCMk201FpeMWVxiAnz60k5a5EKgFVAKiqsJgGKWrkMu6LSI0MEOQsaltcsW8FCMmHCasyAZH2ChISE2xfoOrNM5hPA/QfNRrPkepqlaeuUh2ZW8PGjfHhJ5/i87/9jbX/QQynh/yclHfO8hXYwtR4TcTFkxKTkJqSahkmkddr8UXtdckR+rL/DTe1sdQp44eL5QEu476IXLIBnBckHB5gGUA7tXxw1BCqyurXdwjRI08+hV1HjtoS2Ygp03Bv9x7OwEl07DzZ3B//+j/45D//hFmLl2F0xQzcwUqxS48e+OMXf8XyDZvgZapVX3EBeY48KJNZIINAKiOKeudzIsQbsutnk5uQCdYmCEYNoDc0ZADNeLQU1RseMkhuvpMJWrVpg6q3TtvS+AQCWhtWeGoXidFxGAudM+c+YvX4HkZMnmpLY6lkfDpXNmkSzjENltFw193Y0kIhk2lP56Ii109JTbb9SXGDrJwsWyar9fWAkNbolQU4O0aC6AEeKu688sJUmJdr2+YljUtx5Mw7ZIJbMGbGbFzzI8elNfAYAuGoCZNw5O2zeO31Iygrn45mV3/HzscR1NIys4weHz59BlXsc+Sdd7GWlHpa5UIMZijdT2/KoCdIcW21iS5rA9YfVjlcywawLMBiSLk3FHZWZLVYadSY7igPqJcusEvioLdiy/4DmDi7klz/KqPK8gAzwMTJ2MWUt3LTFjzcrz9jPMUorRZBxflnLWHKo/dcfe116NilK/oPH4VZy1Zi+6Ej2FF12F6S0n1y8nJsPULe5+EYarcaVDmst7SYBZQGbUuKrm95WL+ZGQwII+76PGfr6Nn3MKZiJoLM07FxMUjLSLNzj/d7Fpv37sOCNevQknWC2oQPyQS99PQM4wNPDxxi7SY0ShwJ1EgarpzsMYXZJiEhHtk52fRAvUajdFzbu8MRD7CHiQOExAgjb3Po4SRJIkWiqELm4pKGzASnMZm5PUXrBcwOWjwVqN3B6lCER3yhxQ+uNSXTxRLpBeL+MtzdPXpaezJjXcZLYiZ4ecdOW1lWmCXTyxT7MoBA2DZH/10gqAfKAHJ7YYF+Vy+QsE2xqcE/1Ls3Z3kt3TXW0plWb5QOvfSaRaTAG3fvxbU3OvWBUF7u37ZdexrgXZQ0jSyCRgqhcEkJqs6cRc/H+9jvlFQWRgyB6JK4J6gVoVoMASuHSTjk5lYPEHVldW9kp6Z6i1vpMK8+3TTZWF+He+4laGUZaOUyTerVGSnwcJ8ncYBc/+Z2HRwDsNzV8ZmBg7GHJfV1LVshj/eKT0iw9uYtvo1j732AG9rcbL+FJ3pXKVQoQuZsq9c6BoRIN/UamzFBur/26MwjBEAERomyQb4nz4wgAqO9QzG6uuT/9XPr27mk5ESr7JaTAg8YPsIU0sKHjgOJHRv37MPOw29gG+uAjTt3oXzuPCxcsRK7jx5Hg6ZXWj+9puf3OFvqmgTHALWMAaoGDfDCzsuJeqizVxfh49qoIB7Yq25sEzpnENQ0+6KseQV5ljVkHL1I1bT5t63gaVhaaqCm7JHn8aDRFc3oAa1x30O9MGz8RCx5aQOzxlEsWvcyCuh9sXGsBrMyzNusHK42QC2vCWpBxIiP4l8ZQKGgXZlwJDPQCDqvwehob5D6graRoXQV3fsXg4yyxmYtrkaLa64xUqPd5pSkFGs/X2LjE4z1Nfvu95BCT5EHif3JA6M0XFvmNeIBRQ1Ke7l1uEAiBvASdQ15+WApVD3zPFa3R16oVJtWkJUdomW0MojOaSlbW+FxMbG2CKpKUoWUjKVVHi21CzhTklkHMDtEF0pFfRUuObk5zlY5PU0GtV3imnhA5F8irp3Ol2gWyPdyNn35NsviAlLe3viiB2irTMqpPhceVLcrThkOOhaxaAkWBuwNEBkht36uhUlmupa5OKtURmEihNcsi1fovEJIPEJHeYo8SgYQAOr9ZXkllXIdu5tUG0D/pXHr8FWRAXx6O8Ofb0CoNzmFBUUNqCQV1ixLWYnNOo0TDDkvRdsaopTnOb3IoMHKZY1B+vwULaySWjOmo+uNVnDxvNb7ZXStO8pg6iP01xviektEIKwCTe8IXUoI6CVxxwChUDIv/L1rp/PE8QCRHicL2BaZZpgeYLFPF7eXGvXmFpWufumJacrwgW1SXp6hdieFOq/Gan9Be43/MJaz369+EucVe70i42yG6p0gxb8DgE4YXOqSWKhRo0IzgD7hhk2mu3W6QPSABqUIN2CsKd70OyJqc9r1uzEKGzSy4/l9NEOK02i/6msoxfpt5xpVt321Xfe0718Sp825v8uYXaX0aER15xNq0qSAN/jYvfPXla+Czz8Do+g5Hd2uO//8+W3/TM6/xz+Vz13/VKl/ULh0/ibKxf8697VD4TIVYsSmiKoX/zhp8V+D4mUm+j/kxWf+qx/DhIZNdpx3g8tXvu7fZt0+ShViiiINl5vov5D6N2xEFZdPnTp/B5VoqOAr55qtAAAAAElFTkSuQmCC"
Menu Tray, Icon, % "HBITMAP:*" hICON := CreateBitMap(Base64PNG_icon)
Menu Tray, Icon

CreateBitMap(ByRef strB64) {
	VarSetCapacity(B64, StrLen(strB64) << !!A_IsUnicode) ; Not need on short string
	B64 := strB64, strB64 := "" ; free memory
	If !DllCall("Crypt32.dll\CryptStringToBinary", "Ptr", &B64, "UInt", 0, "UInt", 0x01, "Ptr", 0, "UIntP", DecLen, "Ptr", 0, "Ptr", 0)
		Return False
	VarSetCapacity(Dec, DecLen, 0)
	If !DllCall("Crypt32.dll\CryptStringToBinary", "Ptr", &B64, "UInt", 0, "UInt", 0x01, "Ptr", &Dec, "UIntP", DecLen, "Ptr", 0, "Ptr", 0)
		Return False
	hData := DllCall("Kernel32.dll\GlobalAlloc", "UInt", 2, "UPtr", DecLen, "UPtr")
	pData := DllCall("Kernel32.dll\GlobalLock", "Ptr", hData, "UPtr")
	DllCall("Kernel32.dll\RtlMoveMemory", "Ptr", pData, "Ptr", &Dec, "UPtr", DecLen)
	DllCall("Kernel32.dll\GlobalUnlock", "Ptr", hData)
	DllCall("Ole32.dll\CreateStreamOnHGlobal", "Ptr", hData, "Int", True, "PtrP", pStream)
	hGdip := DllCall("Kernel32.dll\LoadLibrary", "Str", "Gdiplus.dll", "UPtr")
	VarSetCapacity(SI, 16, 0), NumPut(1, SI, 0, "UChar")
	DllCall("Gdiplus.dll\GdiplusStartup", "PtrP", pToken, "Ptr", &SI, "Ptr", 0)
	DllCall("Gdiplus.dll\GdipCreateBitmapFromStream",  "Ptr", pStream, "PtrP", pBitmap)
	DllCall("Gdiplus.dll\GdipCreateHBITMAPFromBitmap", "Ptr", pBitmap, "PtrP", hBitmap, "UInt", 0)
	DllCall("Gdiplus.dll\GdipDisposeImage", "Ptr", pBitmap)
	DllCall("Gdiplus.dll\GdiplusShutdown", "Ptr", pToken)
	DllCall("Kernel32.dll\FreeLibrary", "Ptr", hGdip)
	DllCall(NumGet(NumGet(pStream + 0, 0, "UPtr") + (A_PtrSize * 2), 0, "UPtr"), "Ptr", pStream)
	Return hBitmap
}

~LButton::
KeyWait, LButton, T1
if ErrorLevel {
    while GetKeyState("LButton", "P"){
        Send, +m
        Sleep 25 ; 25 ms delay between clicks, adjust to need.
    }
}
return